<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Silly Platformer + Procedural Sky</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>

<script src="24657e9e-b5cd-4ffb-ad13-664bf89627bb.js"></script>

<script src="https://cdn.jsdelivr.net/npm/three@0.154.0/build/three.min.js"></script>

<script>
// Ground
const ground=new THREE.Mesh(
  new THREE.PlaneGeometry(60,60),
  new THREE.MeshStandardMaterial({color:0x696969})
);

// ===== Camera orbit =====
let azimuth=0, polar=Math.PI/5, radius=8;
const minPolar=0.1,maxPolar=Math.PI/2-0.05;
let lastMouse={x:0,y:0}, mouseInitialized=false;
const mouseSensitivity=0.005;

document.addEventListener('mousemove',e=>{
  if(!mouseInitialized){ lastMouse={x:e.clientX,y:e.clientY}; mouseInitialized=true; return; }
  const dx=e.clientX-lastMouse.x, dy=e.clientY-lastMouse.y;
  azimuth-=dx*mouseSensitivity; polar-=dy*mouseSensitivity;
  polar=Math.max(minPolar,Math.min(maxPolar,polar));
  lastMouse={x:e.clientX, y:e.clientY};
});
document.addEventListener('mouseleave',()=>mouseInitialized=false);
renderer.domElement.addEventListener('wheel', e=>{ radius+=e.deltaY*0.01; radius=Math.max(2,Math.min(30,radius)); });

const keyState={left:false,right:false,up:false,down:false,zoomIn:false,zoomOut:false};
const keyOrbitSpeed=0.02,keyZoomSpeed=0.2;
window.addEventListener('keydown',e=>{
  switch(e.code){ case 'ArrowLeft': keyState.left=true; break; case 'ArrowRight': keyState.right=true; break; case 'ArrowUp': keyState.up=true; break; case 'ArrowDown': keyState.down=true; break; case 'PageUp': keyState.zoomIn=true; break; case 'PageDown': keyState.zoomOut=true; break; }
});
window.addEventListener('keyup',e=>{
  switch(e.code){ case 'ArrowLeft': keyState.left=false; break; case 'ArrowRight': keyState.right=false; break; case 'ArrowUp': keyState.up=false; break; case 'ArrowDown': keyState.down=false; break; case 'PageUp': keyState.zoomIn=false; break; case 'PageDown': keyState.zoomOut=false; break; }
});

function updateCameraKeys(){ if(keyState.left)azimuth-=keyOrbitSpeed; if(keyState.right)azimuth+=keyOrbitSpeed; if(keyState.up)polar-=keyOrbitSpeed; if(keyState.down)polar+=keyOrbitSpeed; polar=Math.max(minPolar,Math.min(maxPolar,polar)); if(keyState.zoomIn)radius-=keyZoomSpeed; if(keyState.zoomOut)radius+=keyZoomSpeed; radius=Math.max(2,Math.min(30,radius)); }
function updateCamera(target){ updateCameraKeys(); const camX=target.x+radius*Math.sin(polar)*Math.sin(azimuth); const camY=target.y+radius*Math.cos(polar)+1; const camZ=target.z+radius*Math.sin(polar)*Math.cos(azimuth); camera.position.set(camX,camY,camZ); camera.lookAt(target.x,target.y+1.4,target.z); }


// ===== Main loop =====
window.addEventListener('resize', ()=>{
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
