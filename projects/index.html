<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sci-Fi Ray Gun Game</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #111;
    }

    #gameArea {
      width: 100vw;
      height: 100vh;
      position: relative;
    }

    #circle {
      width: 80px;
      height: 80px;
      background-color: #3498db;
      border-radius: 50%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1;
      box-shadow: 0 0 20px #3498db;
    }

    #gun {
      width: 20px;
      height: 60px;
      background: linear-gradient(to bottom, #0ff, #0a0a0a);
      border-radius: 10px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform-origin: bottom center;
      transform: translate(-50%, -100%) rotate(0deg);
      z-index: 3;
      box-shadow: 0 0 12px #0ff, inset 0 0 8px #0ff;
    }

    #gun::before {
      content: "";
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      width: 12px;
      height: 25px;
      background: radial-gradient(circle, #0ff, #005);
      border-radius: 50%;
      box-shadow: 0 0 15px #0ff;
      z-index: 5;
    }

    .bullet {
      position: absolute;
      width: 8px;
      height: 8px;
      background: radial-gradient(circle, yellow, orange);
      border-radius: 50%;
      z-index: 2;
      box-shadow: 0 0 10px yellow;
    }

    .obstacle {
      position: absolute;
      width: 40px;
      height: 40px;
      background-color: #e74c3c;
      border-radius: 10px;
      box-shadow: 0 0 15px #e74c3c;
      z-index: 0;
    }

    #score {
      position: absolute;
      top: 20px;
      left: 20px;
      font-size: 24px;
      font-family: Arial, sans-serif;
      color: white;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="gameArea">
    <div id="circle"></div>
    <div id="gun"></div>
    <div id="score">Score: 0</div>
  </div>

  <script>
    const gun = document.getElementById("gun");
    const gameArea = document.getElementById("gameArea");
    const scoreDisplay = document.getElementById("score");

    let angle = 0;
    const step = 15;
    let score = 0;

    function updateGunRotation() {
      gun.style.transform = `translate(-50%, -100%) rotate(${angle}deg)`;
    }

    function getGunTipPosition(a = angle) {
      const centerX = window.innerWidth / 2;
      const centerY = window.innerHeight / 2;
      const rad = (a - 90) * Math.PI / 180;
      const length = 60;

      return {
        x: centerX + Math.cos(rad) * length,
        y: centerY + Math.sin(rad) * length
      };
    }

    function shootBullet() {
      const pos = getGunTipPosition();
      const bullet = document.createElement("div");
      bullet.className = "bullet";
      bullet.style.left = `${pos.x - 4}px`;
      bullet.style.top = `${pos.y - 4}px`;

      const rad = (angle - 90) * Math.PI / 180;
      const speed = 10;
      const vx = Math.cos(rad) * speed;
      const vy = Math.sin(rad) * speed;

      gameArea.appendChild(bullet);

      function moveBullet() {
        const x = parseFloat(bullet.style.left);
        const y = parseFloat(bullet.style.top);
        const newX = x + vx;
        const newY = y + vy;
        bullet.style.left = `${newX}px`;
        bullet.style.top = `${newY}px`;

        const obstacles = document.querySelectorAll(".obstacle");
        obstacles.forEach(ob => {
          const rect = ob.getBoundingClientRect();
          if (
            newX >= rect.left &&
            newX <= rect.right &&
            newY >= rect.top &&
            newY <= rect.bottom
          ) {
            ob.remove();
            bullet.remove();
            score += 1;
            scoreDisplay.textContent = `Score: ${score}`;
            spawnFlyingObstacle();
          }
        });

        if (
          newX < 0 || newX > window.innerWidth ||
          newY < 0 || newY > window.innerHeight
        ) {
          bullet.remove();
          return;
        }

        requestAnimationFrame(moveBullet);
      }

      moveBullet();
    }

    function spawnFlyingObstacle() {
      const edge = Math.floor(Math.random() * 4);
      const ob = document.createElement("div");
      ob.className = "obstacle";
      let x, y;

      switch (edge) {
        case 0: x = Math.random() * window.innerWidth; y = -50; break;
        case 1: x = Math.random() * window.innerWidth; y = window.innerHeight + 50; break;
        case 2: x = -50; y = Math.random() * window.innerHeight; break;
        case 3: x = window.innerWidth + 50; y = Math.random() * window.innerHeight; break;
      }

      ob.style.left = `${x}px`;
      ob.style.top = `${y}px`;
      gameArea.appendChild(ob);

      const centerX = window.innerWidth / 2;
      const centerY = window.innerHeight / 2;
      const dx = centerX - x;
      const dy = centerY - y;
      const dist = Math.hypot(dx, dy);
      const speed = 2;
      const vx = dx / dist * speed;
      const vy = dy / dist * speed;

      function moveObstacle() {
        x += vx;
        y += vy;
        ob.style.left = `${x}px`;
        ob.style.top = `${y}px`;

        if (
          x > -100 && x < window.innerWidth + 100 &&
          y > -100 && y < window.innerHeight + 100
        ) {
          requestAnimationFrame(moveObstacle);
        } else {
          ob.remove();
        }
      }

      moveObstacle();
    }

    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowLeft") {
        angle -= step;
        updateGunRotation();
      } else if (e.key === "ArrowRight") {
        angle += step;
        updateGunRotation();
      } else if (e.key === " " || e.key === "Spacebar") {
        shootBullet();
      }
    });

    for (let i = 0; i < 3; i++) spawnFlyingObstacle();
  </script>
</body>
</html>
