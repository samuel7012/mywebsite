<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Glock Simulation (2D)</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #111;
    }

    #game-area {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    .gun {
      position: absolute;
      width: 200px;
      height: 100px;
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
      transition: transform 0.1s ease-out;
    }

    .body {
      width: 200px;
      height: 50px;
      background: linear-gradient(#222, #444);
      border-radius: 4px;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
      position: absolute;
      bottom: 0;
    }

    .slide {
      width: 200px;
      height: 20px;
      background: linear-gradient(#555, #777);
      border-radius: 4px 4px 0 0;
      position: absolute;
      top: 0;
      transition: transform 0.1s;
      box-shadow: inset 0 -2px 3px rgba(0,0,0,0.5);
    }

    .trigger {
      width: 12px;
      height: 25px;
      background: #888;
      border-radius: 4px;
      position: absolute;
      bottom: 0;
      left: 94px;
      transition: transform 0.1s;
    }

    .sight {
      width: 8px;
      height: 6px;
      background: #000;
      position: absolute;
      top: -6px;
      left: 96px;
      border-radius: 1px;
    }

    .muzzle-flash {
      width: 40px;
      height: 20px;
      background: radial-gradient(yellow, orange, transparent);
      position: absolute;
      top: -10px;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      pointer-events: none;
      border-radius: 50%;
      transition: opacity 0.05s;
    }

    .bullet {
      width: 10px;
      height: 10px;
      background: yellow;
      border-radius: 50%;
      position: absolute;
    }

    .ground {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 20px;
      background: #222;
    }
  </style>
</head>
<body>

<div id="game-area">
  <div class="gun" id="gun">
    <div class="slide"></div>
    <div class="sight"></div>
    <div class="body"></div>
    <div class="trigger"></div>
    <div class="muzzle-flash" id="muzzle-flash"></div>
  </div>
  <div class="ground"></div>
</div>

<!-- Shoot Sound -->
<audio id="shoot-sound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_95c3dbddfa.mp3" preload="auto"></audio>

<script>
  const gameArea = document.getElementById("game-area");
  const gun = document.getElementById("gun");
  const trigger = document.querySelector(".trigger");
  const slide = document.querySelector(".slide");
  const shootSound = document.getElementById("shoot-sound");
  const muzzleFlash = document.getElementById("muzzle-flash");

  // Unlock sound on first user interaction (for Chrome/Firefox restrictions)
  document.body.addEventListener("click", () => {
    shootSound.play().catch(() => {});
  }, { once: true });

  document.addEventListener("mousedown", () => {
    shoot();
  });

  function shoot() {
    // Trigger and slide animation
    trigger.style.transform = "translateY(5px)";
    slide.style.transform = "translateX(-10px)";
    setTimeout(() => {
      trigger.style.transform = "translateY(0)";
      slide.style.transform = "translateX(0)";
    }, 100);

    // Realistic recoil: horizontal back movement + slight upward angle
    gun.style.transform = "translateX(-52%) rotate(-2deg)";
    setTimeout(() => {
      gun.style.transform = "translateX(-50%) rotate(0deg)";
    }, 100);

    // Muzzle flash animation
    muzzleFlash.style.opacity = 1;
    setTimeout(() => {
      muzzleFlash.style.opacity = 0;
    }, 50);

    // Play sound
    shootSound.currentTime = 0;
    shootSound.play().catch(() => {});

    // Create and fire bullet
    const bullet = document.createElement("div");
    bullet.className = "bullet";

    const rect = gun.getBoundingClientRect();
    bullet.style.left = (rect.left + rect.width / 2 - 5) + "px";
    bullet.style.top = (rect.top + 10) + "px";
    gameArea.appendChild(bullet);

    let velocityY = -5;
    let gravity = 0.15;

    function moveBullet() {
      const top = parseFloat(bullet.style.top);
      if (top >= window.innerHeight - 30) {
        bullet.remove();
        return;
      }

      velocityY += gravity;
      bullet.style.top = top + velocityY + "px";
      requestAnimationFrame(moveBullet);
    }

    moveBullet();
  }
</script>

</body>
</html>
